# FitClean Tablet App

React SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–∞ Android 10 –Ω–∞ —Å–º–∞—Ä—Ç-–ª–æ–∫–µ—Ä–µ –ø—Ä–∞—á–µ—á–Ω–æ–π.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚ö° **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - React SPA –Ω–∞ Vite (–Ω–µ Next.js)
- üì± **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–∞** - touch-friendly UI
- üîê **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ª–æ–∫–µ—Ä–æ–º** - RS232/MDB-232 —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- üí≥ **Kaspi QR –æ–ø–ª–∞—Ç–∞** - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å Kaspi API
- üì≤ **WhatsApp —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - OTP –∏ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
- üåç **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - –†—É—Å—Å–∫–∏–π, –ö–∞–∑–∞—Ö—Å–∫–∏–π, English

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tablet-app/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ api/           # API –∫–ª–∏–µ–Ω—Ç—ã (locker, kaspi, whatsapp)
‚îÇ   ‚îú‚îÄ‚îÄ components/    # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # React —Ö—É–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ locales/       # –ü–µ—Ä–µ–≤–æ–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ pages/         # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ store/         # Zustand store
‚îÇ   ‚îî‚îÄ‚îÄ main.tsx       # Entry point
‚îú‚îÄ‚îÄ server/            # –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ª–æ–∫–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ index.js       # HTTP API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ locker-controller.js  # RS232 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ mock-locker.js # –≠–º—É–ª—è—Ç–æ—Ä –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ package.json
```

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd tablet-app
npm install
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd tablet-app/server
npm install
```

## üñ•Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –º–æ–∫-–ª–æ–∫–µ—Ä–æ–º)

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ú–æ–∫-—Å–µ—Ä–≤–µ—Ä –ª–æ–∫–µ—Ä–∞
cd tablet-app/server
npm run mock

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
cd tablet-app
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://localhost:3000`

### –ó–∞–ø—É—Å–∫ —Å —Ä–µ–∞–ª—å–Ω—ã–º –ª–æ–∫–µ—Ä–æ–º

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –°–µ—Ä–≤–µ—Ä —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ª–æ–∫–µ—Ä—É
cd tablet-app/server
SERIAL_PORT=/dev/ttyUSB0 npm start

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
cd tablet-app
npm run dev
```

## üì± –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ

### 1. –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd tablet-app
npm run build
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `dist/` –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ nginx –∏–ª–∏ –¥—Ä—É–≥–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏–∫–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –ª–æ–∫–µ—Ä–∞ –∫–∞–∫ systemd —Å–µ—Ä–≤–∏—Å

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ª–æ–∫–µ—Ä–∞

```bash
# /etc/systemd/system/fitclean-locker.service
[Unit]
Description=FitClean Locker Server
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/fitclean/server
ExecStart=/usr/bin/node index.js
Restart=always
Environment=SERIAL_PORT=/dev/ttyUSB0
Environment=LOCKER_PORT=8080

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable fitclean-locker
sudo systemctl start fitclean-locker
```

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –õ–æ–∫–µ—Ä (KZ004)

–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ RS232/MDB-232 –º–æ–¥—É–ª—å.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `OPEN_CELL` - –æ—Ç–∫—Ä—ã—Ç—å —è—á–µ–π–∫—É
- `QUERY_DOOR_STATUS` - —Å—Ç–∞—Ç—É—Å –¥–≤–µ—Ä–µ–π
- `QUERY_WEIGHT` - –≤–µ—Å –≤ —è—á–µ–π–∫–µ
- `CONTROL_LED` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LED

### Kaspi QR API

–î–ª—è –æ–ø–ª–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kaspi QR API v3.9.

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `VITE_KASPI_MERCHANT_ID` - ID –º–µ—Ä—á–∞–Ω—Ç–∞
- `VITE_KASPI_TERMINAL_ID` - ID —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- `VITE_KASPI_API_KEY` - API –∫–ª—é—á

### WhatsApp (GreenAPI)

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ OTP –∫–æ–¥–æ–≤ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `VITE_WHATSAPP_API_URL`
- `VITE_WHATSAPP_INSTANCE_ID`
- `VITE_WHATSAPP_API_TOKEN`

## üìã Workflow

### –ö–ª–∏–µ–Ω—Ç —Å–¥–∞—ë—Ç –≤–µ—â–∏

1. –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω ‚Üí "–°–¥–∞—Ç—å"
2. –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Üí OTP –≤ WhatsApp
3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–¥–ª—è –Ω–æ–≤—ã—Ö) ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ PIN
4. –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞ ‚Üí –û–ø–ª–∞—Ç–∞ Kaspi QR
5. –Ø—á–µ–π–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚Üí –ö–ª–∏–µ–Ω—Ç –∫–ª–∞–¥—ë—Ç –≤–µ—â–∏
6. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –¥–≤–µ—Ä—å ‚Üí –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω
7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ WhatsApp

### –ö–ª–∏–µ–Ω—Ç –∑–∞–±–∏—Ä–∞–µ—Ç –≤–µ—â–∏

1. –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω ‚Üí "–ó–∞–±—Ä–∞—Ç—å"
2. –í–≤–æ–¥ –∫–æ–¥–∞ –ø–æ–ª—É—á–µ–Ω–∏—è (–∏–∑ WhatsApp)
3. –Ø—á–µ–π–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚Üí –ö–ª–∏–µ–Ω—Ç –∑–∞–±–∏—Ä–∞–µ—Ç –≤–µ—â–∏
4. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –¥–≤–µ—Ä—å ‚Üí –û—Ü–µ–Ω–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

### –ö—É—Ä—å–µ—Ä

1. 3 —Ç–∞–ø–∞ –ø–æ –ª–æ–≥–æ—Ç–∏–ø—É ‚Üí –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è
2. "–ó–∞–±—Ä–∞—Ç—å –≥—Ä—è–∑–Ω–æ–µ" ‚Üí –í—ã–±–æ—Ä —è—á–µ–µ–∫ ‚Üí –û—Ç–∫—Ä—ã—Ç—å
3. "–ü–æ–ª–æ–∂–∏—Ç—å —á–∏—Å—Ç–æ–µ" ‚Üí –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å ID –∑–∞–∫–∞–∑–∞ ‚Üí –Ø—á–µ–π–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

## üåê –Ø–∑—ã–∫–∏

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏:
- üá∑üá∫ –†—É—Å—Å–∫–∏–π (`ru`)
- üá∞üáø “ö–∞–∑–∞“õ—à–∞ (`kk`)
- üá¨üáß English (`en`)

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ —Ö–µ–¥–µ—Ä–µ.

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ—Ä—Ç —Å–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `/dev/ttyUSB0`. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
SERIAL_PORT=/dev/ttyS0 npm start
```

### –†–∞–∑–º–µ—Ä—ã —è—á–µ–µ–∫

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `server/locker-controller.js`:

```javascript
const CELL_SIZES = {
  1: 'S', 2: 'S', 3: 'M', 4: 'M',
  5: 'M', 6: 'M', 7: 'L', 8: 'L',
  // ...
}
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –ª–æ–∫–µ—Ä–∞

```bash
journalctl -u fitclean-locker -f
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –ª–æ–∫–µ—Ä–∞

```bash
# –°—Ç–∞—Ç—É—Å
curl http://localhost:8080/api/locker/status

# –û—Ç–∫—Ä—ã—Ç—å —è—á–µ–π–∫—É
curl -X POST http://localhost:8080/api/locker/cells/cell-5/open

# –°—Ç–∞—Ç—É—Å —è—á–µ–π–∫–∏
curl http://localhost:8080/api/locker/cells/cell-5
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Proprietary - FitClean
